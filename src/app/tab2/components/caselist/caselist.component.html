<ion-menu side="end" menuId="filterMenu" contentId="caselist">
  <ion-header>
    <ion-toolbar color="primary">
      <ion-title>Filter</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list lines="full" class="ion-padding-vertical">

      <ion-item>
        <ion-label position="stacked">Datumsbereich</ion-label>
        <ion-toggle [(ngModel)]="enableDateRangeSearch"></ion-toggle>
      </ion-item>

      <ion-item *ngIf="enableDateRangeSearch">
        <ion-label position="stacked">Startdatum</ion-label>
        <ion-input [value]="startDate | date: 'dd.MM.YYYY'" id="open-start-modal"></ion-input>
      </ion-item>
      <ion-item *ngIf="enableDateRangeSearch">
        <ion-label position="stacked">Enddatum</ion-label>
        <ion-input [value]="endDate | date: 'dd.MM.YYYY'" id="open-end-modal"></ion-input>
      </ion-item>

      <ion-modal id="start-date-modal" trigger="open-start-modal" *ngIf="enableDateRangeSearch">
        <ng-template>
          <ion-datetime [preferWheel]="true" presentation="date" (ionChange)="setStartDate($event)"></ion-datetime>
        </ng-template>
      </ion-modal>

      <ion-modal id="end-date-modal" trigger="open-end-modal" *ngIf="enableDateRangeSearch">
        <ng-template>
          <ion-datetime [preferWheel]="true" presentation="date" (ionChange)="setEndDate($event)"></ion-datetime>
        </ng-template>
      </ion-modal>

      <ion-item>
        <ion-label position="stacked">Falltyp</ion-label>
        <ion-select multiple="true" interface="popover" placeholder="Typ auswählen" [(ngModel)]="selectedCaseTypes">
          <ion-select-option *ngFor="let casetype of caseTypes" [value]="casetype">{{ casetype }}</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Status</ion-label>
        <ion-select interface="popover" placeholder="Status auswählen" [(ngModel)]="selectedStatus">
          <ion-select-option value="open">Offen</ion-select-option>
          <ion-select-option value="closed">Geschlossen</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Umkreissuche</ion-label>
        <ion-toggle [(ngModel)]="enableLocationSearch"></ion-toggle>
      </ion-item>

      <ion-item *ngIf="enableLocationSearch">
        <ion-label position="stacked">Aktuellen Standort verwenden</ion-label>
        <ion-toggle [(ngModel)]="useCurrentLocation" (ionChange)="toggleUseCurrentLocation($event)"></ion-toggle>
      </ion-item>

      <ion-item *ngIf="enableLocationSearch && !useCurrentLocation">
        <ion-label position="stacked">Ort</ion-label>
        <ion-input [(ngModel)]="location" (ionBlur)="checkLocationInput(location)"></ion-input>
      </ion-item>
      <ion-item *ngIf="locations.length > 0 && enableLocationSearch">
        <ion-label>Ort</ion-label>
        <ion-select interface="popover" [(ngModel)]="selectedLocation" (ngModelChange)="onLocationSelected($event)"
                    placeholder="Ort auswählen">
          <ion-select-option *ngFor="let location of locations"
                             [value]="location">{{ location.display_name }}</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item *ngIf="enableLocationSearch">
        <ion-label position="stacked">Umkreis (in km)</ion-label>
        <ion-range min="1" max="100" pin="true" [(ngModel)]="radius">
          <ion-label slot="start">1 km</ion-label>
          <ion-label slot="end">100 km</ion-label>
        </ion-range>
      </ion-item>

      <ion-item lines="none">
        <ion-button expand="block" (click)="applyFilters()">Filter anwenden</ion-button>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>


<ion-header [translucent]="true" id="caselist">
  <ion-toolbar>
    <ion-searchbar placeholder="Suche"></ion-searchbar>
    <ion-buttons slot="end">
      <ion-button (click)="openFilterMenu()">
        <ion-icon slot="icon-only" name="options-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-chip *ngFor="let filter of filters" color="primary">
      <ion-label>
        {{ filter.type === 'caseType' ? 'Falltyp: ' + filter.value : '' }}
        {{ filter.type === 'status' ? 'Status: ' + filter.value : '' }}
        {{ filter.type === 'dateRange' ? formatDateRange(filter.value) : '' }}
      </ion-label>
      <ion-icon name="close-circle" (click)="removeFilter(filter)"></ion-icon>
    </ion-chip>

  </ion-toolbar>
</ion-header>


<ion-list>
  <ion-item-sliding *ngFor="let case of cases">
    <ion-item-options side="start">
      <ion-item-option color="primary">
        <ion-icon name="thumbs-up-outline"></ion-icon>
      </ion-item-option>
      <ion-item-option color="danger">
        <ion-icon name="thumbs-down-outline"></ion-icon>
      </ion-item-option>
    </ion-item-options>

    <ion-item>
      <ion-label>
        <h2>{{ case.title }}</h2>
        <h4>{{ case.case_type }} | {{ case.status }}</h4>
        <p>{{ case.summary }}</p>
      </ion-label>

      <div class="media-icons" slot="end">
        <ion-icon name="mic-circle-outline"></ion-icon>
        <ion-icon name="newspaper-outline"></ion-icon>
        <ion-icon name="images-outline"></ion-icon>
      </div>

      <div class="voting-buttons" slot="end">
        <ion-button>
          <ion-icon name="chevron-up-outline"></ion-icon>
        </ion-button>
        <ion-button>
          <ion-icon name="chevron-down-outline"></ion-icon>
        </ion-button>
      </div>
    </ion-item>

    <ion-item-options side="end">
      <ion-item-option>
        <ion-icon slot="icon-only" name="create-outline"></ion-icon>
      </ion-item-option>
    </ion-item-options>
  </ion-item-sliding>
</ion-list>

<ion-fab vertical="bottom" horizontal="end" slot="fixed">
  <ion-fab-button>
    <ion-icon name="add"></ion-icon>
  </ion-fab-button>
</ion-fab>


